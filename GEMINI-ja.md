# GEMINI.md

開発ルール


## 1. 目的
- サーボ用 Python ドライバ
- **Raspberry Pi Zero 2W** など低スペックでも動作
- **pigpio** 使用
- ライブラリ利用 + CLIで確認・デモ可能


## 2. 全体ルール
- 安易に試行錯誤をせず、情報をしっかり調べること。
- **`git commit`はユーザーのみ**
- 必要時にコミット促し、1行英語メッセージ案を示す
- 設定管理は `uv`, `pyproject.toml` を使用（最新版仕様確認）
- コマンド実行: `uv run ...`
- ライブラリ追加: `uv add ...`
- リンティング:
  - `uv run ruff check ...`
  - `uv run mypy ...`
  - `uv run pyright ...`
- テスト: `tests/`以下に作成、連番で番号付けし、実行は `uv run python -m pytest -v ...`
- ファイル更新は新規作成→差替え


### 2.1 学習とデバッグの原則

過去の失敗を繰り返さず、効率的な問題解決を確実にするために：

- **公式ドキュメントの優先:** コア機能、設定、認証については、常に一次情報源を参照する。二次情報源からの推測は避ける。
- **すべての仮説の検証:** 命名、暗黙の挙動、デフォルト設定に関する仮説を問い直し、検証する。未確認のパターンに基づいて進めない。
- **体系的な問題の切り分け:** 予期せぬ挙動に遭遇した場合、各コンポーネント（例：環境変数、ツール実行、サブプロセス）をテストし、根本原因を特定する。
- **詳細ログの活用:** 利用可能な場合、デバッグオプション（`-v`など）を使用し、内部の洞察を得て、失敗を特定する。
- **ユーザーフィードバックの尊重:** 詳細な報告を継続的な学習と問題診断に活用する。


## 3. コーディング
- コメントは日本語
- 行長 78文字以内
- ログは `my_logger.py` の `get_logger()`使用（変更禁止）


## 4. タスク管理: `ToDo.md` / `Tasks.md`
- まず、`ToDo.md`と`Tasks.md`がプロジェクトルートに存在するか確認する。
  - どちらも存在しない場合、何もしないでユーザーに指示を仰ぐ。
- `ToDo.md`: ユーザー専用
- `Tasks.md`: AI管理
- 作業前に必ず `Tasks.md` を作成または確認し、**実行確認 ('go ahead') を得るまで実行しない**

### 4.1 `Tasks.md` あり
- 未チェックタスクから順に実行
- コード変更時は、常に以下を実施:
  - リンティング
  - テストの作成・更新・実行
- 完了タスクはチェック
- 追加タスクは追記後に確認 ('go ahead')
- 全完了後:
  1. `ToDo.md` チェック更新
  2. `uv run rename_task.py` 実行 → `Tasks.md` を `yyyymmdd-HHMM-Tasks-done.md` にリネームし `archives/`へ

### 4.2 `Tasks.md` なし
- `ToDo.md` を確認し、未チェックの先頭優先項目をタスク化
- 原則として、`ToDo.md`の1項目につき1つの`Tasks.md`を作成する。
- 詳細に分解して `Tasks.md` 作成
- 必ず確認 ('go ahead') 後に実行
